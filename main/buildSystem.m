fdisp(program.logger, 'Build system script initiated.');
tic;

% Sub-elements (surface elements)

Na = cell(4,4);
for i = 1:4
	for j = 1:4
		if i == j
			continue;
		end
		Na(i,j) = [
			mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 1)],2), ...
			mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 2)],2), ...
			mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 3)],2)
		];
	end
end
Ne = cell(4,4,4);
for i = 1:4
	for j = 1:4
		for k = 1:4
			if i == j || j == k || k == i
				continue;
			end
			Ne(i,j,k) = [
				mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,k), 1)],2), ...
				mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,k), 2)],2), ...
				mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,i), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,j), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,k), 3)],2)
			];
		end
	end
end
Ng = [
	mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,1), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,2), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,3), 1), program.analysis.Nodes(program.analysis.ElementNodeIds(:,4), 1)],2), ...
	mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,1), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,2), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,3), 2), program.analysis.Nodes(program.analysis.ElementNodeIds(:,4), 2)],2), ...
	mean([program.analysis.Nodes(program.analysis.ElementNodeIds(:,1), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,2), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,3), 3), program.analysis.Nodes(program.analysis.ElementNodeIds(:,4), 3)],2)
];
calculateSe;
calculateSi;
calculateVolume;

# Geometric Linear Coefficients

## Kij = zeros(rows(program.analysis.ElementNodeIds), 4*4);
## There relations will construct the coefficient matrix and can be derived in
## the 'CalculateLinearCoefficients' script. No one needed to derive these
## relations manually since the symbolic package made the necessary calculations
## with the system these relations came from. Note that these relations are
## purely geometric, therefore can potentially be utilized in other systems
## (other than a thermodynamic system) given the mesh of the problem.
KA = zeros(rows(program.analysis.ElementNodeIds),4);
KB = zeros(rows(program.analysis.ElementNodeIds),4);
KC = zeros(rows(program.analysis.ElementNodeIds),4);
KD = zeros(rows(program.analysis.ElementNodeIds),4);
KA(:,1) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KA(:,2) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KA(:,3) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KA(:,4) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KB(:,1) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KB(:,2) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KB(:,3) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KB(:,4) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KC(:,1) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KC(:,2) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KC(:,3) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KC(:,4) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KD(:,1) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KD(:,2) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KD(:,3) = (-program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));
KD(:,4) = (program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3))./(program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),3) - program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,1),3) + program.analysis.Nodes(program.analysis.ElementNodeIds(:,4),1).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,3),2).*program.analysis.Nodes(program.analysis.ElementNodeIds(:,2),3));


# Linear system

## Coefficient matrix, the matrix that defines the relations between each node.
## This matrix can be extremely giangantic, but will surely be sparse. This
## means that almost all of its elements will be zeros. Therefore, much space
## can be saved in disc by only saving the positions and value of the non zero
## elements and infering that all other elements are zero. The matrix will be
## NxN, and is being declared below, initially with all zeros, but will be
## populated in the next lines.
program.analysis.K = sparse(rows(program.analysis.Nodes),rows(program.analysis.Nodes));

# program.analysis.K([Vetor de linhas] + rows(a)*([Vetor de colunas]-1))

# Connections between nodes through the sub-elements

% Thermal conductivity in W/mmºC
kc = 0.060500*ones(rows(program.analysis.ElementNodeIds),1);

for i = 1:4
	for j = 1:4
		if j == i
			continue;
		end
		for k = 1:4
			program.analysis.Ks = sparse(program.analysis.ElementNodeIds(:,i), program.analysis.ElementNodeIds(:,k), kc.*(KA(:,k).*cell2mat(Si(i,j))(:,1) + KB(:,k).*cell2mat(Si(i,j))(:,2) + KC(:,k).*cell2mat(Si(i,j))(:,3)), rows(program.analysis.K), columns(program.analysis.K));
			program.analysis.K += program.analysis.Ks;
		end
	end
end

fdisp(program.logger, ['Build system script finilized. Execution time: ', num2str(toc), ' s']);